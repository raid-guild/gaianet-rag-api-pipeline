import{u as a,j as e}from"./index-WuhFoIeU.js";const l={title:"Optimism Agora API",description:"undefined"};function n(i){const s={a:"a",code:"code",div:"div",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",span:"span",...a(),...i.components};return e.jsxs(e.Fragment,{children:[e.jsx(s.header,{children:e.jsxs(s.h1,{id:"optimism-agora-api",children:["Optimism Agora API",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#optimism-agora-api",children:e.jsx(s.div,{"data-autolink-icon":!0})})]})}),`
`,e.jsxs(s.p,{children:["The repository includes both the ",e.jsx(s.a,{href:"https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_api_pipeline.yaml",children:"API pipeline manifest"}),`
definition and the `,e.jsx(s.a,{href:"https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_openapi.yaml",children:"OpenAPI spec"}),` to create a RAG pipeline to generate a
knowledge base from RetroPGF projects and proposals within the OP collective. You can usually find these files within the `,e.jsx(s.code,{children:"config"})," folder."]}),`
`,e.jsxs(s.p,{children:["In order to consume data from this API, you are required to request an API key. You can do so by dong a manual request on ",e.jsx(s.a,{href:"https://www.agora.xyz/#Product",children:"Agora's Discord server"}),`
Do not forget to set it under `,e.jsx(s.code,{children:"config/secrets/api-key"})," or specify it directly using the ",e.jsx(s.code,{children:"--api-key"})," argument in the CLI."]}),`
`,e.jsxs(s.h2,{id:"api-pipeline-manifest---overview",children:["API Pipeline manifest - Overview",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#api-pipeline-manifest---overview",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsxs(s.p,{children:["This API pipeline will extract data from the ",e.jsx(s.code,{children:"/proposals"})," and ",e.jsx(s.code,{children:"/projects"})," ",e.jsx(s.a,{href:"https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_api_pipeline.yaml#L79",children:"endpoints"}),`.
There's no need to specify `,e.jsx(s.code,{children:"api_parameters"})," so this sections is ",e.jsx(s.a,{href:"https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_api_pipeline.yaml#L5",children:"empty"}),`.
The requester definition can be seen below. The API uses a BearerAuthenticator schema and gets the `,e.jsx(s.code,{children:"api_token"})," from the ",e.jsx(s.code,{children:"config"})," object."]}),`
`,e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0","data-title":"agora_api_pipeline.yaml","data-lang":"yaml",children:e.jsxs(s.code,{children:[e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:"..."})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"definition"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:":"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:" requester_base"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:":"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    type"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:"HttpRequester"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    url_base"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"https://vote.optimism.io/api/v1"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    http_method"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"GET"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    authenticator"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"# More on https://docs.airbyte.com/connector-development/config-based/understanding-the-yaml-file/authentication"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      type"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:"BearerAuthenticator"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      api_token"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:`"{{ config['api_key'] }}"`})]}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:"..."})})]})}),`
`,e.jsxs(s.p,{children:["The API handles pagination via Offset-based pagination strategy. The page_size is set to 50 while ",e.jsx(s.code,{children:"offset"})," and ",e.jsx(s.code,{children:"limit"}),` parameter values are dynamically
injected into the URL as request parameters.`]}),`
`,e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0","data-title":"agora_api_pipeline.yaml","data-lang":"yaml",children:e.jsxs(s.code,{children:[e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:"..."})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"definition"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:":"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"  paginator"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"# More on https://docs.airbyte.com/connector-development/config-based/understanding-the-yaml-file/pagination"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    type"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:"DefaultPaginator"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    pagination_strategy"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"# More on https://docs.airbyte.com/connector-development/config-based/understanding-the-yaml-file/pagination#offset-increment"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      type"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"OffsetIncrement"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      page_size"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#005CC5","--shiki-dark":"#6CB6FF"},children:"50"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    page_token_option"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:":"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      type"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"RequestOption"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      field_name"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"offset"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      inject_into"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"request_parameter"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"    page_size_option"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:":"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      type"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"RequestOption"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      inject_into"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"request_parameter"'})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"      field_name"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:": "}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:'"limit"'})]}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:"..."})})]})}),`
`,e.jsxs(s.h2,{id:"generating-a-knowledge-base-using-the-rag-api-pipeline-cli",children:["Generating a knowledge base using the ",e.jsx(s.code,{children:"rag-api-pipeline"})," CLI",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#generating-a-knowledge-base-using-the-rag-api-pipeline-cli",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsxs(s.p,{children:["Before executing the ",e.jsx(s.code,{children:"run-all"})," command, make sure you have ",e.jsx(s.code,{children:"Ollama"})," running locally with the LLM embeddings model of your preference:"]}),`
`,e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0","data-title":"Terminal","data-lang":"bash",children:e.jsx(s.code,{children:e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:"poetry"}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:" run"}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:" rag-api-pipeline"}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:" run-all"}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:" config/agora_api_pipeline.yaml"}),e.jsx(s.span,{style:{color:"#005CC5","--shiki-dark":"#6CB6FF"},children:" --openapi-spec-file"}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:" config/agora_openapi.yaml"}),e.jsx(s.span,{style:{color:"#005CC5","--shiki-dark":"#6CB6FF"},children:" --llm-provider"}),e.jsx(s.span,{style:{color:"#032F62","--shiki-dark":"#96D0FF"},children:" ollama"})]})})}),`
`,e.jsxs(s.p,{children:[`Once the command above finishes, you'll find a compressed knowledge base snapshot in
`,e.jsx(s.code,{children:"{OUTPUT_FOLDER}/optimism_agora_api/"})," with name optimism_agora_api_collection-xxxxxxxxxxxxxxxx-yyyy-mm-dd-hh-mm-ss.snapshot.tar.gz`. To import it  into your\ngaianet node, you can find the instructions on how to select a knowledge base ",e.jsx(s.a,{href:"https://docs.gaianet.ai/node-guide/customize#select-a-knowledge-base",children:"here"}),`.
The recommended prompts and node config settings can be found `,e.jsx(s.a,{href:"/node-deployment#recommended-gaianet-node-configuration",children:"here"}),"."]})]})}function o(i={}){const{wrapper:s}={...a(),...i.components};return s?e.jsx(s,{...i,children:e.jsx(n,{...i})}):n(i)}export{o as default,l as frontmatter};
