Here's the improved markdown:

# Optimism Agora API

The repository includes both the [API pipeline manifest](https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_api_pipeline.yaml) definition and the [OpenAPI spec](https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_openapi.yaml) to create a RAG pipeline for generating a knowledge base from RetroPGF projects and proposals within the OP collective. These files are typically located in the `config` folder.

To consume data from this API, you need to request an API key. You can do this by submitting a manual request on [Agora's Discord server](https://www.agora.xyz/#Product). Remember to set the key under `config/secrets/api-key` or specify it directly using the `--api-key` argument in the CLI.

## API Pipeline Manifest - Overview

This API pipeline extracts data from the `/proposals` and `/projects` [endpoints](https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_api_pipeline.yaml#L79). No `api_parameters` need to be specified, so this section is [empty](https://github.com/raid-guild/gaianet-rag-api-pipeline/blob/main/config/agora_api_pipeline.yaml#L5). The requester definition is shown below. The API uses a BearerAuthenticator schema and retrieves the `api_token` from the `config` object.

```yaml [agora_api_pipeline.yaml]
definition:
  requester_base:
    type: HttpRequester
    url_base: "https://vote.optimism.io/api/v1"
    http_method: "GET"
    authenticator:
      type: BearerAuthenticator
      api_token: "{{ config['api_key'] }}"
```

The API handles pagination using an Offset-based pagination strategy. The page_size is set to 50, while `offset` and `limit` parameter values are dynamically injected into the URL as request parameters.

```yaml [agora_api_pipeline.yaml]
definition:
  paginator:
    type: DefaultPaginator
    pagination_strategy:
      type: "OffsetIncrement"
      page_size: 50
    page_token_option:
      type: "RequestOption"
      field_name: "offset"
      inject_into: "request_parameter"
    page_size_option:
      type: "RequestOption"
      inject_into: "request_parameter"
      field_name: "limit"
```

## Generating a Knowledge Base Using the `rag-api-pipeline` CLI

Before executing the `run-all` command, ensure that `Ollama` is running locally with your preferred LLM embeddings model:

```bash
poetry run rag-api-pipeline run-all config/agora_api_pipeline.yaml --openapi-spec-file config/agora_openapi.yaml --llm-provider ollama
```

After the command completes, you'll find a compressed knowledge base snapshot in `{OUTPUT_FOLDER}/optimism_agora_api/` named `optimism_agora_api_collection-xxxxxxxxxxxxxxxx-yyyy-mm-dd-hh-mm-ss.snapshot.tar.gz`. For instructions on importing it into your gaianet node, refer to the documentation on [selecting a knowledge base](https://docs.gaianet.ai/node-guide/customize#select-a-knowledge-base). The recommended prompts and node configuration settings can be found in the [node deployment guide](/node-deployment#recommended-gaianet-node-configuration).